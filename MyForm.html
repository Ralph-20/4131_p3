<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MyForm</title>
    <link rel="stylesheet" href="style.css">

    <!-- <style>
        /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
#map {
  height: 100%;
}

/* Optional: Makes the sample page fill the window. */
html,
body {
  height: 100%;
  margin: 0;
  padding: 0;
}

.title {
  font-weight: bold;
}

#infowindow-content {
  display: none;
}

#map #infowindow-content {
  display: inline;
}
    </style> -->

    <script>

        

        function initMap() {
            const origin = { lat: -33.871, lng: 151.197 };
            const map = new google.maps.Map(document.getElementById("map"), {
                zoom: 18,
                center: origin,
            });

            new ClickEventHandler(map, origin);
            }


            function isIconMouseEvent(e) {
            return "placeId" in e;
            }

            class ClickEventHandler {
            origin;
            map;
            directionsService;
            directionsRenderer;
            placesService;
            infowindow;
            infowindowContent;
            constructor(map, origin) {
                this.origin = origin;
                this.map = map;
                this.directionsService = new google.maps.DirectionsService();
                this.directionsRenderer = new google.maps.DirectionsRenderer();
                this.directionsRenderer.setMap(map);
                this.placesService = new google.maps.places.PlacesService(map);
                this.infowindow = new google.maps.InfoWindow();
                this.infowindowContent = document.getElementById("infowindow-content");
                this.infowindow.setContent(this.infowindowContent);
                // Listen for clicks on the map.
                this.map.addListener("click", this.handleClick.bind(this));
            }
            handleClick(event) {
                console.log("You clicked on: " + event.latLng);
                // If the event has a placeId, use it.
                if (isIconMouseEvent(event)) {
                console.log("You clicked on place:" + event.placeId);
                // Calling e.stop() on the event prevents the default info window from
                // showing.
                // If you call stop here when there is no placeId you will prevent some
                // other map click event handlers from receiving the event.
                var input = document.getElementById('location');
                input.innerHTML = event.placeId;
                event.stop();
                if (event.placeId) {
                    // this.calculateAndDisplayRoute(event.placeId);
                    this.getPlaceInformation(event.placeId);
                }
                }
            }

            getPlaceInformation(placeId) {
                const me = this;

                this.placesService.getDetails({ placeId: placeId }, (place, status) => {
                if (
                    status === "OK" &&
                    place &&
                    place.geometry &&
                    place.geometry.location
                ) {
                    me.infowindow.close();
                    me.infowindow.setPosition(place.geometry.location);
                    me.infowindowContent.children["place-icon"].src = place.icon;
                    me.infowindowContent.children["place-name"].textContent = place.name;
                    me.infowindowContent.children["place-id"].textContent = place.place_id;
                    me.infowindowContent.children["place-address"].textContent =
                    place.formatted_address;
                    me.infowindow.open(me.map);

                    // setting the location here 
                    
                    var input = document.getElementById('location');
                    input.value = place.formatted_address; 

                }
                });
            }
            }

        window.initMap = initMap;
    </script>
    <script
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyABgyWvYgmjDSfkJGSO7qXQOZo1XnBLezs&callback=initMap&libraries=places&v=weekly"
    defer
  ></script>

</head>
<body>

    <!-- This is the header  -->
    <header>
        <nav>
          <ul class="navbar">
            <li class="navbarli"><a href="AboutMe.html">About Me</a></li>
            <li class="navbarli"><a href="MySchedule.html">Schedule</a></li>
            <li class="navbarli"><a href="MyForm.html">Form</a></li>
          </ul>
        </nav>
    </header>
    
    <div class="wrapper">
        <form method="post" action = "https://www-users.cselabs.umn.edu/~cuixx327/a2.php">
            
            <!-- hidden inputs below - no visual inputs that will -->
            <!-- be submitted when the form is submitted -->
            <input type = "hidden" name = "recipient"
                value = "challou@cs.umn.edu">
            <input type = "hidden" name = "subject"
                value = "Feedback Form">
            <input type = "hidden" name = "redirect"
                value = "http://www.cs.umn.edu/">
            
            <!-- input type = "text" inserts a text field -->
            <p>
                <label>Event:</label>
                <input name = "event" type = "text" size = "25" id="event"
                    maxlength = "30" pattern="[a-zA-Z0-9\s]+" title="Must be alphanumeric" required >
                
            </p>
            
            <p>   
                <label> Day of Week:</label>
                <select name="day" size="1" id="day" required >
                    <option value="" disabled selected>Select an option</option>
                    <option value="Sun">Sun</option>
                    <option value="Mon">Mon</option>
                    <option value="Tue">Tue</option>
                    <option value="Wed">Wed</option>
                    <option value="Thu">Thu</option>
                    <option value="Fri">Fri</option>
                    <option value="Sat">Sat</option>
                </select>
            </p>

            <p>
                <label> Start time:</label>
                <input name="start" type="time" id="start" required >        
            </p>

            <p>
                <label> End time:</label>
                <input name="end" type="time" id="end" required >        
            </p>
            <p>
                <label> Phone:</label>
                <input name="phone" type="tel" pattern="[0-9]{3}-[0-9]{3}-[0-9]{4}" placeholder="123-456-7889" id="phone" required > 
            </p>

            <p>
                <label> Location:</label>
                <input name="location" type="text" id="location" required >        
            </p>

            <p>
                <label> Extra info:</label>
                <input name="extra" type="text" id="extra" required >        
            </p>

            <p>
                <label> Enter URL for the extra info:</label>
                <input name="url" type="url" id="url" required >        
            </p>
        
            <!-- submit and reset insert buttons for submitting -->
            <!-- and clearing the form's contents				-->
            <p>
                <input type = "submit" value = "Submit" >
                <!-- <input type = "reset" value = "Clear" > -->
            </p>
        
        </form>



    </div>



    <div id="map"></div>
    <div id="infowindow-content">
      <img id="place-icon" src="" height="16" width="16" />
      <span id="place-name" class="title"></span><br />
      Place ID <span id="place-id"></span><br />
      <span id="place-address"></span>
    </div>




    
</body>
</html>